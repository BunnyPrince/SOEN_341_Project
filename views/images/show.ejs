<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-giJF6kkoqNQ00vy+HMDP7azOuL0xtbfIcaT9wjKHr8RbDVddVHyTfAAsrekwKmP1" crossorigin="anonymous">
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta1/dist/js/bootstrap.bundle.min.js" integrity="sha384-ygbV9kiqUc6oa4msXn9868pTtWMgiQaeYH7/t7LECLbyPA2x65Kgf80OJFdroafW" crossorigin="anonymous"></script>
<link href="/style/basic.css" rel="stylesheet" type="text/css">
<link href="/style/custom.css" rel="stylesheet" type="text/css">

<%- include('../partials/header')  %>
<main>
    <h1>Show page</h1>
    <!-- Image -->
    <div style="padding:30px;margin:30px">
        <img src="<%= image.url %>" height="500px">
        <div>
            <a href="/<%= imgUser.username %>"> <%= imgUser.username %> </a>
        </div>
        <p><%= image.caption %></p>
    </div>

    <!-- Delete/Edit buttons -->
    <% if (permission) { %>
        <div>
            <form action="/images/<%=image._id%>?_method=DELETE" method="POST">
                <button>Delete</button>
            </form>
            <form action="/images/<%= image._id %>/edit" method="GET">
                <button>Edit</button>
            </form>
        </div>
    <% } %>
    <!-- Show comments -->
    <% for (const comment of image.comments) {%>
        <div style="margin: 30px; padding: 40px; border: solid 1px black">
            <b>
                <%= comment.username %>
            </b>
            <br>
            <%= comment.comment %>
            <!-- Delete comment -->
            <form action="/images/<%=image._id%>/comments/<%=comment._id%>?_method=DELETE" method="POST" >
                <button>Delete comment</button>
            </form>
        </div>
    <% } %>
    <!-- Add comment -->
    <div style="padding:30px;margin:30px">
        <form action="/images/<%= image._id %>/comments" method="POST">
            <input type="text" name="comment[username]" placeholder="Commenter name">
            <br>
            <textarea rows="10" cols="50" id="textbox" placeholder="Add comment" name="comment[comment]"></textarea>
            <button>Comment!</button>
        </form>
    </div>
</main>

<%- include('../partials/footer') %>
